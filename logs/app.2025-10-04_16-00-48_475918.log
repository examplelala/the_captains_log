2025-10-04 16:59:30 | INFO     | logging:callHandlers:1706 - 3.113.242.250:0 - "GET /weather/103.8331/1.3062 HTTP/1.1" 200
2025-10-04 16:59:30 | INFO     | logging:callHandlers:1706 - 3.113.242.250:0 - "GET /news/stackoverflow?limit=3 HTTP/1.1" 200
2025-10-04 16:59:30 | INFO     | logging:callHandlers:1706 - 3.113.242.250:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 16:59:59 | INFO     | logging:callHandlers:1706 - 3.113.242.250:0 - "OPTIONS /record/ai/1/query HTTP/1.1" 200
2025-10-04 17:00:00 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 17:00:00 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 17:00:02 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: today_summary
2025-10-04 17:00:02 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 0 æ¡å€™é€‰è®°å½•
2025-10-04 17:00:02 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 17:00:07 | INFO     | routes.record:ai_query:173 - æŸ¥è¯¢æˆåŠŸ
2025-10-04 17:00:07 | INFO     | logging:callHandlers:1706 - 3.113.242.250:0 - "POST /record/ai/1/query HTTP/1.1" 200
2025-10-04 17:12:54 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /news/shaoshupai?limit=3 HTTP/1.1" 200
2025-10-04 17:12:54 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:12:56 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /weather/104.04312807239234/30.548201741350006 HTTP/1.1" 200
2025-10-04 17:13:47 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "OPTIONS /record/users/1/records/ HTTP/1.1" 200
2025-10-04 17:13:48 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 17:13:53 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 17:13:53 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 17:13:53 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 17:13:54 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "POST /record/users/1/records/ HTTP/1.1" 200
2025-10-04 17:13:54 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 17:13:56 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:14:02 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:14:07 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:14:12 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /news/douyin?limit=3 HTTP/1.1" 200
2025-10-04 17:14:12 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:14:13 | INFO     | logging:callHandlers:1706 - 2408:8469:b330:2ead:b9fc:58a1:4ddf:87b0:0 - "GET /weather/104.04317765351084/30.54818893449018 HTTP/1.1" 200
2025-10-04 17:17:13 | INFO     | logging:callHandlers:1706 - 112.45.110.205:0 - "GET /weather/104.04264556424324/30.547818966033937 HTTP/1.1" 200
2025-10-04 17:17:13 | INFO     | logging:callHandlers:1706 - 112.45.110.205:0 - "GET /news/v2ex?limit=3 HTTP/1.1" 200
2025-10-04 17:17:13 | INFO     | logging:callHandlers:1706 - 112.45.110.205:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 17:32:01 | INFO     | logging:callHandlers:1706 - 101.91.148.219:0 - "GET / HTTP/1.1" 200
2025-10-04 19:35:54 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:35:54 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:35:54 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:35:54 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:35:54 | INFO     | logging:callHandlers:1706 - Finished server process [2385219]
2025-10-04 19:35:59 | INFO     | logging:callHandlers:1706 - Started server process [2439611]
2025-10-04 19:35:59 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:35:59 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:35:59 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:35:59 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:35:59 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:36:00 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:36:15 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:36:16 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:36:16 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:36:16 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:36:16 | INFO     | logging:callHandlers:1706 - Finished server process [2439611]
2025-10-04 19:36:20 | INFO     | logging:callHandlers:1706 - Started server process [2439791]
2025-10-04 19:36:20 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:36:20 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:36:20 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:36:20 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:36:20 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:36:21 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:36:26 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:36:26 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:36:26 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:36:26 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:36:26 | INFO     | logging:callHandlers:1706 - Finished server process [2439791]
2025-10-04 19:37:01 | INFO     | logging:callHandlers:1706 - Started server process [2440218]
2025-10-04 19:37:01 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:37:01 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:37:01 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:37:01 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:37:01 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:37:02 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:38:20 | INFO     | logging:callHandlers:1706 - 35.75.4.127:0 - "GET /news/zhihu?limit=3 HTTP/1.1" 200
2025-10-04 19:38:21 | INFO     | logging:callHandlers:1706 - 35.75.4.127:0 - "GET /weather/104.043625/30.547167 HTTP/1.1" 200
2025-10-04 19:38:21 | INFO     | logging:callHandlers:1706 - 35.75.4.127:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 19:42:41 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-04 19:42:42 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "GET /weather/104.043621/30.547713 HTTP/1.1" 200
2025-10-04 19:42:42 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "GET /news/tieba?limit=3 HTTP/1.1" 200
2025-10-04 19:42:55 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "OPTIONS /record/ai/1/query HTTP/1.1" 200
2025-10-04 19:42:55 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 19:42:56 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 19:42:58 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 19:42:58 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 19:42:58 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:42:58 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:42:58 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:42:58 | INFO     | agents.langgraph.nodes:retrieve_node:457 - === å°è¯• 1/3 ===
2025-10-04 19:42:58 | INFO     | agents.langgraph.nodes:retrieve_node:458 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 19:42:58 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 500
2025-10-04 19:42:58 | ERROR    | logging:callHandlers:1706 - Exception in ASGI application

Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 3
               â”‚     â”” 11
               â”” <function _main at 0x7f3abbea2b60>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 3
           â”‚    â”” <function BaseProcess._bootstrap at 0x7f3abbdacc20>
           â”” <SpawnProcess name='SpawnProcess-13' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x7f3abbdac180>
    â”” <SpawnProcess name='SpawnProcess-13' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x7f39719168d0>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-13' parent=2381933 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-13' parent=2381933 started>
    â”‚    â”” <function subprocess_started at 0x7f3971887ec0>
    â”” <SpawnProcess name='SpawnProcess-13' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x7f3971917750>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x7f3971887240>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x7f3971917750>
           â”‚       â”” <function run at 0x7f3abb51f920>
           â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x7f3abbddac50>
           â”‚      â”” <function Runner.run at 0x7f3abb544900>
           â”” <asyncio.runners.Runner object at 0x7f3971916610>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at /home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvi...
           â”‚    â”‚     â”” <cyfunction Loop.run_until_complete at 0x7f39718df1d0>
           â”‚    â”” <uvloop.Loop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x7f3971916610>
> File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f39714cd550>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f396d7a11...
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f396d7...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
                 â”‚    â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f39719528d0>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f39714cd550>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 84, in __call__
    raise exc from None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 80, in __call__
    await self.app(scope, inner_receive, inner_send)
          â”‚    â”‚   â”‚      â”‚              â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f396d7bb9c0>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <fastapi.applications.FastAPI object at 0x7f397154f0d0>
          â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f39719528d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f396d7bb9c0>
                           â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f396d7bb9c0>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f397158fed0>
          â”” <fastapi.applications.FastAPI object at 0x7f397154f0d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f396d7bb6a0>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f397158fe10>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f397158fed0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          â”‚    â”‚               â”‚      â”‚        â”‚                     â”” Headers({'host': 'dabinglian.chat', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like ...
          â”‚    â”‚               â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f396d7bb6a0>
          â”‚    â”‚               â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚               â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function CORSMiddleware.simple_response at 0x7f3971a27740>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f397158fe10>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f397158fe10>>, ...
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f397158fdd0>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f397158fe10>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f397158fe10>>, ...
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x7f396d6b27d0>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x7f397154f450>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f397158fdd0>
          â”” <function wrap_app_handling_exceptions at 0x7f3aba4ea840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d7bb560>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <fastapi.routing.APIRouter object at 0x7f397154f450>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d7bb560>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f397154f450>>
          â”” <fastapi.routing.APIRouter object at 0x7f397154f450>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d7bb560>
          â”‚     â”‚      â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚     â”” <function Route.handle at 0x7f3aba4ebe20>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d7bb560>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function request_response.<locals>.app at 0x7f3971594180>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d7bb560>
          â”‚                            â”‚    â”‚        â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x7f396d6b25d0>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x7f3971597ec0>
          â”” <function wrap_app_handling_exceptions at 0x7f3aba4ea840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f396d6ae200>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f396d7bb7e0>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <function request_response.<locals>.app.<locals>.app at 0x7f3971597ec0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x7f396d6b25d0>
                     â”” <function get_request_handler.<locals>.app at 0x7f3971594040>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x7f3abbf36a20>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'db': <sqlalchemy.orm.session.AsyncSession object at 0x7f396d6b2cd0>, 'user_id': 1, 'data': DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')}
                 â”‚         â”” <function ai_query at 0x7f3971a26b60>
                 â”” Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='user_id', mode='validation')], query_params=[], h...

  File "/home/lisq/the_captains_log/routes/record.py", line 172, in ai_query
    result = await respond(user_id=user_id, user_query=data.query, session=db)
                   â”‚               â”‚                   â”‚    â”‚              â”” <sqlalchemy.orm.session.AsyncSession object at 0x7f396d6b2cd0>
                   â”‚               â”‚                   â”‚    â”” 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'
                   â”‚               â”‚                   â”” DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')
                   â”‚               â”” 1
                   â”” <function respond at 0x7f3972758540>

  File "/home/lisq/the_captains_log/agents/langgraph/graph.py", line 59, in respond
    final_state: AgentState = await app.ainvoke(initial)
                                    â”‚   â”‚       â”” {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'}
                                    â”‚   â”” <function Pregel.ainvoke at 0x7f3971ff60c0>
                                    â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f396d6bdfd0>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 3112, in ainvoke
    async for chunk in self.astream(
              â”‚        â”‚    â”” <function Pregel.astream at 0x7f3971ff5f80>
              â”‚        â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f396d6bdfd0>
              â”” ('values', {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-1...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 2939, in astream
    async for _ in runner.atick(
              â”‚    â”‚      â”” <function PregelRunner.atick at 0x7f3971fc7ec0>
              â”‚    â”” <langgraph.pregel._runner.PregelRunner object at 0x7f396d796550>
              â”” None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
          â”” <function arun_with_retry at 0x7f3971fc7600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
                 â”‚    â”‚            â”‚    â”‚      â”” {'configurable': {'__pregel_runtime': Runtime(context=None, store=None, stream_writer=<function Pregel.astream.<locals>.strea...
                 â”‚    â”‚            â”‚    â”” <member 'input' of 'PregelExecutableTask' objects>
                 â”‚    â”‚            â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
                 â”‚    â”” <member 'proc' of 'PregelExecutableTask' objects>
                 â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
                  â”‚       â”” <function create_task at 0x7f3abb52c5e0>
                  â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
                â”‚    â”‚      â”‚       â”” {}
                â”‚    â”‚      â”” ({'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-10-04', 'ca...
                â”‚    â”” functools.partial(<function retrieve_node at 0x7f3971a25c60>, session=<sqlalchemy.orm.session.AsyncSession object at 0x7f396d...
                â”” retrieve(tags=None, recurse=True, explode_args=False, func_accepts={})

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 461, in retrieve_node
    retrieved = await _search_in_time_range(
                      â”” <function _search_in_time_range at 0x7f3971a25bc0>

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 325, in _search_in_time_range
    from models import DailyRecord  # å‡è®¾ä½ çš„æ¨¡å‹åä¸º DailyRecord
                       â”” <class 'models.daily_record.DailyRecord'>

ImportError: cannot import name 'DailyRecord' from 'models' (/home/lisq/the_captains_log/models/__init__.py)
During task with name 'retrieve' and id '4ae484f2-b3b5-6f7c-19bb-79254359af50'
2025-10-04 19:47:05 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:47:06 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:47:06 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:47:06 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:47:06 | INFO     | logging:callHandlers:1706 - Finished server process [2440218]
2025-10-04 19:47:10 | INFO     | logging:callHandlers:1706 - Started server process [2445171]
2025-10-04 19:47:10 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:47:10 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:47:10 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:47:10 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:47:10 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:47:11 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:49:45 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 19:49:46 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 19:49:47 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 19:49:47 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 19:49:47 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:49:47 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:49:47 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:49:48 | INFO     | agents.langgraph.nodes:retrieve_node:456 - === å°è¯• 1/3 ===
2025-10-04 19:49:48 | INFO     | agents.langgraph.nodes:retrieve_node:457 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 19:49:48 | ERROR    | agents.langgraph.nodes:_search_in_time_range:404 - å‘é‡æœç´¢å¤±è´¥: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: è¯­æ³•é”™è¯¯ åœ¨ ":" æˆ–é™„è¿‘çš„
[SQL: SELECT daily_records.id, $1::INTEGER - CAST(vector <=> :qv::vector AS FLOAT) AS similarity 
FROM daily_records 
WHERE daily_records.user_id = $2::INTEGER AND daily_records.vector IS NOT NULL ORDER BY vector <=> :qv::vector 
 LIMIT $3::INTEGER]
[parameters: (1, 1, 10)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-04 19:49:48 | ERROR    | agents.langgraph.nodes:_search_in_time_range:409 - FTSæœç´¢å¤±è´¥: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥
[SQL: SELECT daily_records.id, ts_rank_cd(to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections), to_tsquery($3::REGCONFIG, $4::VARCHAR)) AS rank 
FROM daily_records 
WHERE (to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections) @@ to_tsquery($3::REGCONFIG, $4::VARCHAR)) AND daily_records.user_id = $5::INTEGER ORDER BY ts_rank_cd(to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections), to_tsquery($3::REGCONFIG, $4::VARCHAR)) DESC 
 LIMIT $6::INTEGER]
[parameters: ('english', ' ', 'english', 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 1, 10)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-10-04 19:49:48 | INFO     | agents.langgraph.nodes:retrieve_node:471 - æ£€ç´¢åˆ° 0 æ¡è®°å½•
2025-10-04 19:49:48 | INFO     | agents.langgraph.nodes:retrieve_node:475 - ç»“æœæ•° < 2ï¼Œç›´æ¥æ‰©å±•æ—¶é—´èŒƒå›´
2025-10-04 19:49:48 | WARNING  | agents.langgraph.nodes:retrieve_node:543 - æ‰€æœ‰å°è¯•éƒ½å¤±è´¥ï¼Œä½¿ç”¨æ—¶é—´å…œåº•
2025-10-04 19:49:48 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 500
2025-10-04 19:49:48 | ERROR    | logging:callHandlers:1706 - Exception in ASGI application

Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 3
               â”‚     â”” 11
               â”” <function _main at 0x7fa450572b60>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 3
           â”‚    â”” <function BaseProcess._bootstrap at 0x7fa45047cc20>
           â”” <SpawnProcess name='SpawnProcess-14' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x7fa45047c180>
    â”” <SpawnProcess name='SpawnProcess-14' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x7fa305eb6a50>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-14' parent=2381933 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-14' parent=2381933 started>
    â”‚    â”” <function subprocess_started at 0x7fa3060e3ec0>
    â”” <SpawnProcess name='SpawnProcess-14' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x7fa305eb78d0>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x7fa3060e3240>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x7fa305eb78d0>
           â”‚       â”” <function run at 0x7fa44fbef920>
           â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x7fa4504aac50>
           â”‚      â”” <function Runner.run at 0x7fa44fc14900>
           â”” <asyncio.runners.Runner object at 0x7fa305eb6790>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at /home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvi...
           â”‚    â”‚     â”” <cyfunction Loop.run_until_complete at 0x7fa3061331d0>
           â”‚    â”” <uvloop.Loop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x7fa305eb6790>
> File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa305b86e50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa301e5f0...
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa301e...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
                 â”‚    â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7fa305ef2b50>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fa305b86e50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 84, in __call__
    raise exc from None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 80, in __call__
    await self.app(scope, inner_receive, inner_send)
          â”‚    â”‚   â”‚      â”‚              â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fa301e1b420>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <fastapi.applications.FastAPI object at 0x7fa305b87250>
          â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7fa305ef2b50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fa301e1b420>
                           â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fa301e1b420>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa305bcff50>
          â”” <fastapi.applications.FastAPI object at 0x7fa305b87250>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa301e1b380>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fa305bcfe90>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa305bcff50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          â”‚    â”‚               â”‚      â”‚        â”‚                     â”” Headers({'host': 'dabinglian.chat', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like ...
          â”‚    â”‚               â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa301e1b380>
          â”‚    â”‚               â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚               â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function CORSMiddleware.simple_response at 0x7fa306083740>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fa305bcfe90>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fa305bcfe90>>, ...
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa305bcfe50>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fa305bcfe90>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fa305bcfe90>>, ...
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x7fa301e5f8d0>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x7fa305b87590>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa305bcfe50>
          â”” <function wrap_app_handling_exceptions at 0x7fa44ebba840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b560>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <fastapi.routing.APIRouter object at 0x7fa305b87590>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b560>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fa305b87590>>
          â”” <fastapi.routing.APIRouter object at 0x7fa305b87590>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b560>
          â”‚     â”‚      â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚     â”” <function Route.handle at 0x7fa44ebbbe20>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b560>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function request_response.<locals>.app at 0x7fa305bd0180>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b560>
          â”‚                            â”‚    â”‚        â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x7fa301e27cd0>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x7fa301e1b600>
          â”” <function wrap_app_handling_exceptions at 0x7fa44ebba840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa301e1b740>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fa305bd3ec0>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <function request_response.<locals>.app.<locals>.app at 0x7fa301e1b600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x7fa301e27cd0>
                     â”” <function get_request_handler.<locals>.app at 0x7fa305bd0040>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x7fa450606a20>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'db': <sqlalchemy.orm.session.AsyncSession object at 0x7fa301df3f50>, 'user_id': 1, 'data': DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')}
                 â”‚         â”” <function ai_query at 0x7fa306082b60>
                 â”” Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='user_id', mode='validation')], query_params=[], h...

  File "/home/lisq/the_captains_log/routes/record.py", line 172, in ai_query
    result = await respond(user_id=user_id, user_query=data.query, session=db)
                   â”‚               â”‚                   â”‚    â”‚              â”” <sqlalchemy.orm.session.AsyncSession object at 0x7fa301df3f50>
                   â”‚               â”‚                   â”‚    â”” 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'
                   â”‚               â”‚                   â”” DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')
                   â”‚               â”” 1
                   â”” <function respond at 0x7fa306fb4540>

  File "/home/lisq/the_captains_log/agents/langgraph/graph.py", line 59, in respond
    final_state: AgentState = await app.ainvoke(initial)
                                    â”‚   â”‚       â”” {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'}
                                    â”‚   â”” <function Pregel.ainvoke at 0x7fa3066520c0>
                                    â”” <langgraph.graph.state.CompiledStateGraph object at 0x7fa301e7b1d0>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 3112, in ainvoke
    async for chunk in self.astream(
              â”‚        â”‚    â”” <function Pregel.astream at 0x7fa306651f80>
              â”‚        â”” <langgraph.graph.state.CompiledStateGraph object at 0x7fa301e7b1d0>
              â”” ('values', {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-1...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 2939, in astream
    async for _ in runner.atick(
              â”‚    â”‚      â”” <function PregelRunner.atick at 0x7fa306623ec0>
              â”‚    â”” <langgraph.pregel._runner.PregelRunner object at 0x7fa301e5f110>
              â”” None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
          â”” <function arun_with_retry at 0x7fa306623600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
                 â”‚    â”‚            â”‚    â”‚      â”” {'configurable': {'__pregel_runtime': Runtime(context=None, store=None, stream_writer=<function Pregel.astream.<locals>.strea...
                 â”‚    â”‚            â”‚    â”” <member 'input' of 'PregelExecutableTask' objects>
                 â”‚    â”‚            â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
                 â”‚    â”” <member 'proc' of 'PregelExecutableTask' objects>
                 â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
                  â”‚       â”” <function create_task at 0x7fa44fbfc5e0>
                  â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
                â”‚    â”‚      â”‚       â”” {}
                â”‚    â”‚      â”” ({'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-10-04', 'ca...
                â”‚    â”” functools.partial(<function retrieve_node at 0x7fa306081c60>, session=<sqlalchemy.orm.session.AsyncSession object at 0x7fa301...
                â”” retrieve(tags=None, recurse=True, explode_args=False, func_accepts={})

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 551, in retrieve_node
    result = await session.execute(text(fallback_sql), {"user_id": user_id})
                   â”‚       â”‚       â”‚    â”‚                          â”” 1
                   â”‚       â”‚       â”‚    â”” '\n            SELECT id, user_id, record_date, content, mood_score, reflections\n            FROM daily_records\n           ...
                   â”‚       â”‚       â”” <function text at 0x7fa44dc823e0>
                   â”‚       â”” <function AsyncSession.execute at 0x7fa44d785d00>
                   â”” <sqlalchemy.orm.session.AsyncSession object at 0x7fa301df3f50>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   â”” <function greenlet_spawn at 0x7fa44e1ff600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             â”‚       â”‚      â”‚   â”” <built-in function exc_info>
             â”‚       â”‚      â”” <module 'sys' (built-in)>
             â”‚       â”” <method 'throw' of 'greenlet.greenlet' objects>
             â”” <_AsyncIoGreenlet object at 0x7fa2e9fbcb40 (otid=0x7fa44e208690) dead>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           â”‚    â”” <function Session._execute_internal at 0x7fa44d883e20>
           â”” <sqlalchemy.orm.session.Session object at 0x7fa301e37090>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             â”‚    â”” <function Connection.execute at 0x7fa44dafcf40>
             â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           â”” <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x7fa2ec9e9110>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           â”‚          â”” <function Connection._execute_clauseelement at 0x7fa44dafd260>
           â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          â”‚    â”” <function Connection._execute_context at 0x7fa44dafd440>
          â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           â”‚    â”” <function Connection._exec_single_context at 0x7fa44dafd4e0>
           â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    â”‚    â”” <function Connection._handle_dbapi_exception at 0x7fa44dafd760>
    â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          â”‚                    â”‚              â”‚                 â”” Error("<class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥")
          â”‚                    â”‚              â”” (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error'>, Error("<class 'asyncpg.exceptions.InFailedS...
          â”‚                    â”” <method 'with_traceback' of 'BaseException' objects>
          â”” DBAPIError("(sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢,...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    â”‚    â”‚       â”” <function DefaultDialect.do_execute at 0x7fa44dba4d60>
    â”‚    â”” <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x7fa440569f50>
    â”” <sqlalchemy.engine.base.Connection object at 0x7fa2eca001d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    â”‚      â”‚       â”‚          â”” (1,)
    â”‚      â”‚       â”” '\n            SELECT id, user_id, record_date, content, mood_score, reflections\n            FROM daily_records\n           ...
    â”‚      â”” <function AsyncAdapt_asyncpg_cursor.execute at 0x7fa4404f8fe0>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fa2eca1f3a0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    â”‚    â”” <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fa2eca1f3a0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           â”‚       â”‚             â”” <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x7fa301cde7a0>
           â”‚       â”” <attribute 'parent' of 'greenlet.greenlet' objects>
           â”” <_AsyncIoGreenlet object at 0x7fa2e9fbcb40 (otid=0x7fa44e208690) dead>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  â”” <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x7fa301cde7a0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    â”‚    â”” <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x7fa4404f8e00>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fa2eca1f3a0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    â”‚    â”‚                                   â”” InFailedSQLTransactionError('å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥')
    â”‚    â”” <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fa2eca1f3a0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
          â”‚                     â”” InFailedSQLTransactionError('å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥')
          â”” Error("<class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥")

sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥
[SQL: 
            SELECT id, user_id, record_date, content, mood_score, reflections
            FROM daily_records
            WHERE user_id = $1
            ORDER BY record_date DESC
            LIMIT 5
        ]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
During task with name 'retrieve' and id '949b08ea-096b-5a39-5cc7-129d02d1b16c'
2025-10-04 19:54:13 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:54:14 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:54:14 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:54:14 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:54:14 | INFO     | logging:callHandlers:1706 - Finished server process [2445171]
2025-10-04 19:54:18 | INFO     | logging:callHandlers:1706 - Started server process [2448673]
2025-10-04 19:54:18 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:54:18 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:54:18 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:54:18 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:54:18 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:54:19 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:54:21 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:54:21 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:54:21 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:54:21 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:54:21 | INFO     | logging:callHandlers:1706 - Finished server process [2448673]
2025-10-04 19:54:26 | INFO     | logging:callHandlers:1706 - Started server process [2448792]
2025-10-04 19:54:26 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:54:26 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:54:26 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:54:26 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:54:26 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:54:27 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:54:36 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "OPTIONS /record/ai/1/query HTTP/1.1" 200
2025-10-04 19:54:36 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 19:54:37 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 19:54:38 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 19:54:38 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 19:54:38 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:54:38 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:54:38 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:54:38 | INFO     | agents.langgraph.nodes:retrieve_node:443 - === å°è¯• 1/3 ===
2025-10-04 19:54:38 | INFO     | agents.langgraph.nodes:retrieve_node:444 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 19:54:38 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 500
2025-10-04 19:54:38 | ERROR    | logging:callHandlers:1706 - Exception in ASGI application

Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 3
               â”‚     â”” 11
               â”” <function _main at 0x7f7e6aa5ab60>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 3
           â”‚    â”” <function BaseProcess._bootstrap at 0x7f7e6a964c20>
           â”” <SpawnProcess name='SpawnProcess-16' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x7f7e6a964180>
    â”” <SpawnProcess name='SpawnProcess-16' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x7f7d20382a50>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-16' parent=2381933 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-16' parent=2381933 started>
    â”‚    â”” <function subprocess_started at 0x7f7d205afec0>
    â”” <SpawnProcess name='SpawnProcess-16' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x7f7d203838d0>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x7f7d205af240>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x7f7d203838d0>
           â”‚       â”” <function run at 0x7f7e6a0d7920>
           â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x7f7e6a992c50>
           â”‚      â”” <function Runner.run at 0x7f7e6a0fc900>
           â”” <asyncio.runners.Runner object at 0x7f7d203828d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at /home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvi...
           â”‚    â”‚     â”” <cyfunction Loop.run_until_complete at 0x7f7d205ff1d0>
           â”‚    â”” <uvloop.Loop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x7f7d203828d0>
> File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f7d203beb10>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f7d1c3378...
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f7d1c3...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
                 â”‚    â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f7d20567e10>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f7d203beb10>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 84, in __call__
    raise exc from None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 80, in __call__
    await self.app(scope, inner_receive, inner_send)
          â”‚    â”‚   â”‚      â”‚              â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f7d1c2ef6a0>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <fastapi.applications.FastAPI object at 0x7f7d2005b2d0>
          â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f7d20567e10>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f7d1c2ef6a0>
                           â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f7d1c2ef6a0>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f7d200a3fd0>
          â”” <fastapi.applications.FastAPI object at 0x7f7d2005b2d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f7d1c2ef740>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f7d200a3ed0>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f7d200a3fd0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          â”‚    â”‚               â”‚      â”‚        â”‚                     â”” Headers({'host': 'dabinglian.chat', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like ...
          â”‚    â”‚               â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f7d1c2ef740>
          â”‚    â”‚               â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚               â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function CORSMiddleware.simple_response at 0x7f7d2054f740>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f7d200a3ed0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f7d200a3ed0>>, ...
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f7d200a3750>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f7d200a3ed0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f7d200a3ed0>>, ...
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x7f7d1c2c5810>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x7f7d2005b650>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f7d200a3750>
          â”” <function wrap_app_handling_exceptions at 0x7f7e690a2840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2ef880>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <fastapi.routing.APIRouter object at 0x7f7d2005b650>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2ef880>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f7d2005b650>>
          â”” <fastapi.routing.APIRouter object at 0x7f7d2005b650>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2ef880>
          â”‚     â”‚      â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚     â”” <function Route.handle at 0x7f7e690a3e20>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2ef880>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function request_response.<locals>.app at 0x7f7d200a4180>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2ef880>
          â”‚                            â”‚    â”‚        â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x7f7d1c2f1350>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x7f7d1c2ef920>
          â”” <function wrap_app_handling_exceptions at 0x7f7e690a2840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f7d1c2efa60>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f7d1c2ef600>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <function request_response.<locals>.app.<locals>.app at 0x7f7d1c2ef920>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x7f7d1c2f1350>
                     â”” <function get_request_handler.<locals>.app at 0x7f7d200a4040>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x7f7e6aaeea20>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'db': <sqlalchemy.orm.session.AsyncSession object at 0x7f7d1c336910>, 'user_id': 1, 'data': DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')}
                 â”‚         â”” <function ai_query at 0x7f7d2054eb60>
                 â”” Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='user_id', mode='validation')], query_params=[], h...

  File "/home/lisq/the_captains_log/routes/record.py", line 172, in ai_query
    result = await respond(user_id=user_id, user_query=data.query, session=db)
                   â”‚               â”‚                   â”‚    â”‚              â”” <sqlalchemy.orm.session.AsyncSession object at 0x7f7d1c336910>
                   â”‚               â”‚                   â”‚    â”” 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'
                   â”‚               â”‚                   â”” DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')
                   â”‚               â”” 1
                   â”” <function respond at 0x7f7d21488540>

  File "/home/lisq/the_captains_log/agents/langgraph/graph.py", line 59, in respond
    final_state: AgentState = await app.ainvoke(initial)
                                    â”‚   â”‚       â”” {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'}
                                    â”‚   â”” <function Pregel.ainvoke at 0x7f7d20b220c0>
                                    â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f7d1c295410>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 3112, in ainvoke
    async for chunk in self.astream(
              â”‚        â”‚    â”” <function Pregel.astream at 0x7f7d20b21f80>
              â”‚        â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f7d1c295410>
              â”” ('values', {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-1...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 2939, in astream
    async for _ in runner.atick(
              â”‚    â”‚      â”” <function PregelRunner.atick at 0x7f7d20af3ec0>
              â”‚    â”” <langgraph.pregel._runner.PregelRunner object at 0x7f7d1c3ac8d0>
              â”” None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
          â”” <function arun_with_retry at 0x7f7d20af3600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
                 â”‚    â”‚            â”‚    â”‚      â”” {'configurable': {'__pregel_runtime': Runtime(context=None, store=None, stream_writer=<function Pregel.astream.<locals>.strea...
                 â”‚    â”‚            â”‚    â”” <member 'input' of 'PregelExecutableTask' objects>
                 â”‚    â”‚            â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
                 â”‚    â”” <member 'proc' of 'PregelExecutableTask' objects>
                 â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
                  â”‚       â”” <function create_task at 0x7f7e6a0e45e0>
                  â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
                â”‚    â”‚      â”‚       â”” {}
                â”‚    â”‚      â”” ({'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-10-04', 'ca...
                â”‚    â”” functools.partial(<function retrieve_node at 0x7f7d2054dc60>, session=<sqlalchemy.orm.session.AsyncSession object at 0x7f7d1c...
                â”” retrieve(tags=None, recurse=True, explode_args=False, func_accepts={})

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 447, in retrieve_node
    retrieved = await _search_in_time_range(
                      â”” <function _search_in_time_range at 0x7f7d2054dbc0>

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 333, in _search_in_time_range
    sql_text("(1 - (vector <=> :qv::vector))").label('similarity')
    â”” <function text at 0x7f7e6816a3e0>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/sql/roles.py", line 177, in label
    raise NotImplementedError()

NotImplementedError
During task with name 'retrieve' and id 'dae205cc-8b01-89a6-c5d2-3d51439e7330'
2025-10-04 19:55:44 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:55:44 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:55:44 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:55:44 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:55:44 | INFO     | logging:callHandlers:1706 - Finished server process [2448792]
2025-10-04 19:55:49 | INFO     | logging:callHandlers:1706 - Started server process [2449523]
2025-10-04 19:55:49 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:55:49 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:55:49 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:55:49 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:55:49 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:55:49 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:56:05 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 19:56:06 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 19:56:07 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 19:56:08 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 19:56:08 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:56:08 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:56:08 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:56:08 | INFO     | agents.langgraph.nodes:retrieve_node:441 - === å°è¯• 1/3 ===
2025-10-04 19:56:08 | INFO     | agents.langgraph.nodes:retrieve_node:442 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 19:56:08 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 500
2025-10-04 19:56:08 | ERROR    | logging:callHandlers:1706 - Exception in ASGI application

Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 3
               â”‚     â”” 11
               â”” <function _main at 0x7f77c8b7ab60>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 3
           â”‚    â”” <function BaseProcess._bootstrap at 0x7f77c8a84c20>
           â”” <SpawnProcess name='SpawnProcess-17' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x7f77c8a84180>
    â”” <SpawnProcess name='SpawnProcess-17' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x7f767e5f6f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-17' parent=2381933 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-17' parent=2381933 started>
    â”‚    â”” <function subprocess_started at 0x7f767e56bec0>
    â”” <SpawnProcess name='SpawnProcess-17' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x7f767e5f7e10>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x7f767e56b240>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x7f767e5f7e10>
           â”‚       â”” <function run at 0x7f77c81eb920>
           â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x7f77c8ab2c50>
           â”‚      â”” <function Runner.run at 0x7f77c8210900>
           â”” <asyncio.runners.Runner object at 0x7f767eb706d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at /home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvi...
           â”‚    â”‚     â”” <cyfunction Loop.run_until_complete at 0x7f767e5bb1d0>
           â”‚    â”” <uvloop.Loop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x7f767eb706d0>
> File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f767e632ed0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f767c101e...
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f767c1...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
                 â”‚    â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f767e713790>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f767e632ed0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 84, in __call__
    raise exc from None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 80, in __call__
    await self.app(scope, inner_receive, inner_send)
          â”‚    â”‚   â”‚      â”‚              â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f767c12b420>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <fastapi.applications.FastAPI object at 0x7f767e257490>
          â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7f767e713790>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f767c12b420>
                           â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7f767c12b420>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f767e713bd0>
          â”” <fastapi.applications.FastAPI object at 0x7f767e257490>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f767c12b380>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f767e2a4190>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f767e713bd0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          â”‚    â”‚               â”‚      â”‚        â”‚                     â”” Headers({'host': 'dabinglian.chat', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like ...
          â”‚    â”‚               â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f767c12b380>
          â”‚    â”‚               â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚               â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function CORSMiddleware.simple_response at 0x7f767e707740>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f767e2a4190>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f767e2a4190>>, ...
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f767e2a4150>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7f767e2a4190>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7f767e2a4190>>, ...
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x7f767c1117d0>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x7f767e257810>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f767e2a4150>
          â”” <function wrap_app_handling_exceptions at 0x7f77c71ca840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b560>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <fastapi.routing.APIRouter object at 0x7f767e257810>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b560>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f767e257810>>
          â”” <fastapi.routing.APIRouter object at 0x7f767e257810>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b560>
          â”‚     â”‚      â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚     â”” <function Route.handle at 0x7f77c71cbe20>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b560>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function request_response.<locals>.app at 0x7f767e2a0180>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b560>
          â”‚                            â”‚    â”‚        â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x7f767c102710>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x7f767c12b600>
          â”” <function wrap_app_handling_exceptions at 0x7f77c71ca840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f767c12b740>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7f767c12b240>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <function request_response.<locals>.app.<locals>.app at 0x7f767c12b600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x7f767c102710>
                     â”” <function get_request_handler.<locals>.app at 0x7f767e2a0040>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x7f77c8c12a20>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'db': <sqlalchemy.orm.session.AsyncSession object at 0x7f767c110e50>, 'user_id': 1, 'data': DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')}
                 â”‚         â”” <function ai_query at 0x7f767e706b60>
                 â”” Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='user_id', mode='validation')], query_params=[], h...

  File "/home/lisq/the_captains_log/routes/record.py", line 172, in ai_query
    result = await respond(user_id=user_id, user_query=data.query, session=db)
                   â”‚               â”‚                   â”‚    â”‚              â”” <sqlalchemy.orm.session.AsyncSession object at 0x7f767c110e50>
                   â”‚               â”‚                   â”‚    â”” 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'
                   â”‚               â”‚                   â”” DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')
                   â”‚               â”” 1
                   â”” <function respond at 0x7f767f438540>

  File "/home/lisq/the_captains_log/agents/langgraph/graph.py", line 59, in respond
    final_state: AgentState = await app.ainvoke(initial)
                                    â”‚   â”‚       â”” {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'}
                                    â”‚   â”” <function Pregel.ainvoke at 0x7f767ecd60c0>
                                    â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f7676289b90>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 3112, in ainvoke
    async for chunk in self.astream(
              â”‚        â”‚    â”” <function Pregel.astream at 0x7f767ecd5f80>
              â”‚        â”” <langgraph.graph.state.CompiledStateGraph object at 0x7f7676289b90>
              â”” ('values', {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-1...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 2939, in astream
    async for _ in runner.atick(
              â”‚    â”‚      â”” <function PregelRunner.atick at 0x7f767eca7ec0>
              â”‚    â”” <langgraph.pregel._runner.PregelRunner object at 0x7f767c11d2d0>
              â”” None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
          â”” <function arun_with_retry at 0x7f767eca7600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
                 â”‚    â”‚            â”‚    â”‚      â”” {'configurable': {'__pregel_runtime': Runtime(context=None, store=None, stream_writer=<function Pregel.astream.<locals>.strea...
                 â”‚    â”‚            â”‚    â”” <member 'input' of 'PregelExecutableTask' objects>
                 â”‚    â”‚            â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
                 â”‚    â”” <member 'proc' of 'PregelExecutableTask' objects>
                 â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
                  â”‚       â”” <function create_task at 0x7f77c81f85e0>
                  â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
                â”‚    â”‚      â”‚       â”” {}
                â”‚    â”‚      â”” ({'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-10-04', 'ca...
                â”‚    â”” functools.partial(<function retrieve_node at 0x7f767e705c60>, session=<sqlalchemy.orm.session.AsyncSession object at 0x7f767c...
                â”” retrieve(tags=None, recurse=True, explode_args=False, func_accepts={})

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 445, in retrieve_node
    retrieved = await _search_in_time_range(
                      â”” <function _search_in_time_range at 0x7f767e705bc0>

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 333, in _search_in_time_range
    literal_column("(1 - (vector <=> :qv::vector))").label('similarity')

NameError: name 'literal_column' is not defined
During task with name 'retrieve' and id 'f04d975f-b291-4e48-ff41-a5e48180aeeb'
2025-10-04 19:57:29 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 19:57:29 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 19:57:29 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 19:57:29 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 19:57:29 | INFO     | logging:callHandlers:1706 - Finished server process [2449523]
2025-10-04 19:57:34 | INFO     | logging:callHandlers:1706 - Started server process [2450423]
2025-10-04 19:57:34 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 19:57:34 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 19:57:34 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:57:34 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:57:34 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:57:34 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 19:58:19 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 19:58:20 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 19:58:21 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 19:58:21 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 19:58:21 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:retrieve_node:441 - === å°è¯• 1/3 ===
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:retrieve_node:442 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 19:58:21 | ERROR    | agents.langgraph.nodes:_search_in_time_range:389 - å‘é‡æœç´¢å¤±è´¥: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: è¯­æ³•é”™è¯¯ åœ¨ ":" æˆ–é™„è¿‘çš„
[SQL: SELECT daily_records.id, (1 - (vector <=> :qv::vector)) AS similarity 
FROM daily_records 
WHERE daily_records.user_id = $1::INTEGER AND daily_records.vector IS NOT NULL ORDER BY vector <=> :qv::vector 
 LIMIT $2::INTEGER]
[parameters: (1, 10)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-04 19:58:21 | ERROR    | agents.langgraph.nodes:_search_in_time_range:394 - FTSæœç´¢å¤±è´¥: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥
[SQL: SELECT daily_records.id, ts_rank_cd(to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections), to_tsquery($3::REGCONFIG, $4::VARCHAR)) AS rank 
FROM daily_records 
WHERE (to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections) @@ to_tsquery($3::REGCONFIG, $4::VARCHAR)) AND daily_records.user_id = $5::INTEGER ORDER BY ts_rank_cd(to_tsvector($1::REGCONFIG, daily_records.content || $2::VARCHAR || daily_records.reflections), to_tsquery($3::REGCONFIG, $4::VARCHAR)) DESC 
 LIMIT $6::INTEGER]
[parameters: ('english', ' ', 'english', 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 1, 10)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:retrieve_node:456 - æ£€ç´¢åˆ° 0 æ¡è®°å½•
2025-10-04 19:58:21 | INFO     | agents.langgraph.nodes:retrieve_node:460 - ç»“æœæ•° < 2ï¼Œç›´æ¥æ‰©å±•æ—¶é—´èŒƒå›´
2025-10-04 19:58:21 | WARNING  | agents.langgraph.nodes:retrieve_node:528 - æ‰€æœ‰å°è¯•éƒ½å¤±è´¥ï¼Œä½¿ç”¨æ—¶é—´å…œåº•
2025-10-04 19:58:21 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 500
2025-10-04 19:58:21 | ERROR    | logging:callHandlers:1706 - Exception in ASGI application

Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â”‚     â”‚   â”” 3
               â”‚     â”” 11
               â”” <function _main at 0x7fdc71ba6b60>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â”‚    â”‚          â”” 3
           â”‚    â”” <function BaseProcess._bootstrap at 0x7fdc71ab0c20>
           â”” <SpawnProcess name='SpawnProcess-18' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    â”‚    â”” <function BaseProcess.run at 0x7fdc71ab0180>
    â”” <SpawnProcess name='SpawnProcess-18' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â”‚    â”‚        â”‚    â”‚        â”‚    â”” {'config': <uvicorn.config.Config object at 0x7fdb275bed50>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    â”‚    â”‚        â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-18' parent=2381933 started>
    â”‚    â”‚        â”‚    â”” ()
    â”‚    â”‚        â”” <SpawnProcess name='SpawnProcess-18' parent=2381933 started>
    â”‚    â”” <function subprocess_started at 0x7fdb2772fec0>
    â”” <SpawnProcess name='SpawnProcess-18' parent=2381933 started>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â”‚              â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
    â”” <bound method Server.run of <uvicorn.server.Server object at 0x7fdb275bfbd0>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/server.py", line 67, in run
    return asyncio.run(self.serve(sockets=sockets))
           â”‚       â”‚   â”‚    â”‚             â”” [<socket.socket fd=4, family=2, type=1, proto=0, laddr=('0.0.0.0', 18080)>]
           â”‚       â”‚   â”‚    â”” <function Server.serve at 0x7fdb2772f240>
           â”‚       â”‚   â”” <uvicorn.server.Server object at 0x7fdb275bfbd0>
           â”‚       â”” <function run at 0x7fdc71227920>
           â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           â”‚      â”‚   â”” <coroutine object Server.serve at 0x7fdc71adec50>
           â”‚      â”” <function Runner.run at 0x7fdc7124c900>
           â”” <asyncio.runners.Runner object at 0x7fdb27574d90>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â”‚    â”‚     â”‚                  â”” <Task pending name='Task-1' coro=<Server.serve() running at /home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvi...
           â”‚    â”‚     â”” <cyfunction Loop.run_until_complete at 0x7fdb275831d0>
           â”‚    â”” <uvloop.Loop running=True closed=False debug=False>
           â”” <asyncio.runners.Runner object at 0x7fdb27574d90>
> File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fdb27631790>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â”‚    â”‚   â”‚      â”‚        â”” <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fdb246ef7...
                 â”‚    â”‚   â”‚      â”” <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fdb246...
                 â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
                 â”‚    â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7fdb275fa990>
                 â”” <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7fdb27631790>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 84, in __call__
    raise exc from None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/uvicorn/middleware/message_logger.py", line 80, in __call__
    await self.app(scope, inner_receive, inner_send)
          â”‚    â”‚   â”‚      â”‚              â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fdb2468f420>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <fastapi.applications.FastAPI object at 0x7fdb271db310>
          â”” <uvicorn.middleware.message_logger.MessageLoggerMiddleware object at 0x7fdb275fa990>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fdb2468f420>
                           â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
                           â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_send at 0x7fdb2468f420>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fdb2722c0d0>
          â”” <fastapi.applications.FastAPI object at 0x7fdb271db310>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          â”‚    â”‚   â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fdb2468f380>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fdb318cced0>
          â”” <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fdb2722c0d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          â”‚    â”‚               â”‚      â”‚        â”‚                     â”” Headers({'host': 'dabinglian.chat', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like ...
          â”‚    â”‚               â”‚      â”‚        â”” <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fdb2468f380>
          â”‚    â”‚               â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚               â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function CORSMiddleware.simple_response at 0x7fdb276d3740>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fdb318cced0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fdb318cced0>>, ...
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fdb2722c090>
          â”” <starlette.middleware.cors.CORSMiddleware object at 0x7fdb318cced0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”‚        â”” functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7fdb318cced0>>, ...
          â”‚                            â”‚    â”‚    â”‚     â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚                            â”‚    â”‚    â”‚     â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”‚    â”” <starlette.requests.Request object at 0x7fdb246ef590>
          â”‚                            â”‚    â”” <fastapi.routing.APIRouter object at 0x7fdb271db690>
          â”‚                            â”” <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fdb2722c090>
          â”” <function wrap_app_handling_exceptions at 0x7fdc70206840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f560>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <fastapi.routing.APIRouter object at 0x7fdb271db690>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          â”‚    â”‚                â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f560>
          â”‚    â”‚                â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚                â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fdb271db690>>
          â”” <fastapi.routing.APIRouter object at 0x7fdb271db690>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
          â”‚     â”‚      â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f560>
          â”‚     â”‚      â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚     â”‚      â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚     â”” <function Route.handle at 0x7fdc70207e20>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
          â”‚    â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f560>
          â”‚    â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚    â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚    â”” <function request_response.<locals>.app at 0x7fdb27224180>
          â”” APIRoute(path='/record/ai/{user_id}/query', name='ai_query', methods=['POST'])
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 78, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          â”‚                            â”‚    â”‚        â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f560>
          â”‚                            â”‚    â”‚        â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚                            â”‚    â”‚        â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”‚                            â”‚    â”” <starlette.requests.Request object at 0x7fdb27248050>
          â”‚                            â”” <function request_response.<locals>.app.<locals>.app at 0x7fdb2468f600>
          â”” <function wrap_app_handling_exceptions at 0x7fdc70206840>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â”‚   â”‚      â”‚        â”” <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fdb2468f740>
          â”‚   â”‚      â”” <function MessageLoggerMiddleware.__call__.<locals>.inner_receive at 0x7fdb2468f240>
          â”‚   â”” {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 18080), 'c...
          â”” <function request_response.<locals>.app.<locals>.app at 0x7fdb2468f600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
                     â”‚ â”” <starlette.requests.Request object at 0x7fdb27248050>
                     â”” <function get_request_handler.<locals>.app at 0x7fdb27224040>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                         â”” <function run_endpoint_function at 0x7fdc71c3aa20>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
                 â”‚         â”‚      â”” {'db': <sqlalchemy.orm.session.AsyncSession object at 0x7fdb2759cdd0>, 'user_id': 1, 'data': DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')}
                 â”‚         â”” <function ai_query at 0x7fdb276d2b60>
                 â”” Dependant(path_params=[ModelField(field_info=Path(PydanticUndefined), name='user_id', mode='validation')], query_params=[], h...

  File "/home/lisq/the_captains_log/routes/record.py", line 172, in ai_query
    result = await respond(user_id=user_id, user_query=data.query, session=db)
                   â”‚               â”‚                   â”‚    â”‚              â”” <sqlalchemy.orm.session.AsyncSession object at 0x7fdb2759cdd0>
                   â”‚               â”‚                   â”‚    â”” 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'
                   â”‚               â”‚                   â”” DailyQuery(query='æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›')
                   â”‚               â”” 1
                   â”” <function respond at 0x7fdb28604540>

  File "/home/lisq/the_captains_log/agents/langgraph/graph.py", line 59, in respond
    final_state: AgentState = await app.ainvoke(initial)
                                    â”‚   â”‚       â”” {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›'}
                                    â”‚   â”” <function Pregel.ainvoke at 0x7fdb27ca60c0>
                                    â”” <langgraph.graph.state.CompiledStateGraph object at 0x7fdb246e7810>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 3112, in ainvoke
    async for chunk in self.astream(
              â”‚        â”‚    â”” <function Pregel.astream at 0x7fdb27ca5f80>
              â”‚        â”” <langgraph.graph.state.CompiledStateGraph object at 0x7fdb246e7810>
              â”” ('values', {'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-1...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/main.py", line 2939, in astream
    async for _ in runner.atick(
              â”‚    â”‚      â”” <function PregelRunner.atick at 0x7fdb27c77ec0>
              â”‚    â”” <langgraph.pregel._runner.PregelRunner object at 0x7fdb246ec310>
              â”” None
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_runner.py", line 295, in atick
    await arun_with_retry(
          â”” <function arun_with_retry at 0x7fdb27c77600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/pregel/_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
                 â”‚    â”‚            â”‚    â”‚      â”” {'configurable': {'__pregel_runtime': Runtime(context=None, store=None, stream_writer=<function Pregel.astream.<locals>.strea...
                 â”‚    â”‚            â”‚    â”” <member 'input' of 'PregelExecutableTask' objects>
                 â”‚    â”‚            â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
                 â”‚    â”” <member 'proc' of 'PregelExecutableTask' objects>
                 â”” PregelExecutableTask(name='retrieve', input={'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': ...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 706, in ainvoke
    input = await asyncio.create_task(
                  â”‚       â”” <function create_task at 0x7fdc712345e0>
                  â”” <module 'asyncio' from '/home/lisq/.conda/envs/mindsense/lib/python3.11/asyncio/__init__.py'>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/langgraph/_internal/_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
                â”‚    â”‚      â”‚       â”” {}
                â”‚    â”‚      â”” ({'user_id': 1, 'query': 'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°éƒ½æœ‰å“ªäº›', 'intent': 'recent_summary', 'start_date': '2025-09-27', 'end_date': '2025-10-04', 'ca...
                â”‚    â”” functools.partial(<function retrieve_node at 0x7fdb276d1c60>, session=<sqlalchemy.orm.session.AsyncSession object at 0x7fdb27...
                â”” retrieve(tags=None, recurse=True, explode_args=False, func_accepts={})

  File "/home/lisq/the_captains_log/agents/langgraph/nodes.py", line 536, in retrieve_node
    result = await session.execute(text(fallback_sql), {"user_id": user_id})
                   â”‚       â”‚       â”‚    â”‚                          â”” 1
                   â”‚       â”‚       â”‚    â”” '\n            SELECT id, user_id, record_date, content, mood_score, reflections\n            FROM daily_records\n           ...
                   â”‚       â”‚       â”” <function text at 0x7fdc6f2d63e0>
                   â”‚       â”” <function AsyncSession.execute at 0x7fdc6ededd00>
                   â”” <sqlalchemy.orm.session.AsyncSession object at 0x7fdb2759cdd0>

  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/ext/asyncio/session.py", line 463, in execute
    result = await greenlet_spawn(
                   â”” <function greenlet_spawn at 0x7fdc6f843600>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             â”‚       â”‚      â”‚   â”” <built-in function exc_info>
             â”‚       â”‚      â”” <module 'sys' (built-in)>
             â”‚       â”” <method 'throw' of 'greenlet.greenlet' objects>
             â”” <_AsyncIoGreenlet object at 0x7fdb0f6d9440 (otid=0x7fdc6f84c690) dead>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
           â”‚    â”” <function Session._execute_internal at 0x7fdc6eee7e20>
           â”” <sqlalchemy.orm.session.Session object at 0x7fdb2465f2d0>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2260, in _execute_internal
    result = conn.execute(
             â”‚    â”” <function Connection.execute at 0x7fdc6f154f40>
             â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           â”” <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.elements.TextClause object at 0x7fdb0f782dd0>>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           â”‚          â”” <function Connection._execute_clauseelement at 0x7fdc6f155260>
           â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          â”‚    â”” <function Connection._execute_context at 0x7fdc6f155440>
          â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           â”‚    â”” <function Connection._exec_single_context at 0x7fdc6f1554e0>
           â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    â”‚    â”” <function Connection._handle_dbapi_exception at 0x7fdc6f155760>
    â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          â”‚                    â”‚              â”‚                 â”” Error("<class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥")
          â”‚                    â”‚              â”” (<class 'sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error'>, Error("<class 'asyncpg.exceptions.InFailedS...
          â”‚                    â”” <method 'with_traceback' of 'BaseException' objects>
          â”” DBAPIError("(sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢,...
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    â”‚    â”‚       â”” <function DefaultDialect.do_execute at 0x7fdc6f1fcd60>
    â”‚    â”” <sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg object at 0x7fdc61bd1d10>
    â”” <sqlalchemy.engine.base.Connection object at 0x7fdb1c140c50>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    â”‚      â”‚       â”‚          â”” (1,)
    â”‚      â”‚       â”” '\n            SELECT id, user_id, record_date, content, mood_score, reflections\n            FROM daily_records\n           ...
    â”‚      â”” <function AsyncAdapt_asyncpg_cursor.execute at 0x7fdc61b60fe0>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fdb1c13a620>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    â”‚    â”” <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fdb1c13a620>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           â”‚       â”‚             â”” <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x7fdb240ae560>
           â”‚       â”” <attribute 'parent' of 'greenlet.greenlet' objects>
           â”” <_AsyncIoGreenlet object at 0x7fdb0f6d9440 (otid=0x7fdc6f84c690) dead>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
                  â”” <coroutine object AsyncAdapt_asyncpg_cursor._prepare_and_execute at 0x7fdb240ae560>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    â”‚    â”” <function AsyncAdapt_asyncpg_cursor._handle_exception at 0x7fdc61b60e00>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fdb1c13a620>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    â”‚    â”‚                                   â”” InFailedSQLTransactionError('å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥')
    â”‚    â”” <member '_adapt_connection' of 'AsyncAdapt_asyncpg_cursor' objects>
    â”” <sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor object at 0x7fdb1c13a620>
  File "/home/lisq/.conda/envs/mindsense/lib/python3.11/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
          â”‚                     â”” InFailedSQLTransactionError('å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥')
          â”” Error("<class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥")

sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InFailedSQLTransactionError'>: å½“å‰äº‹åŠ¡è¢«ç»ˆæ­¢, äº‹åŠ¡å—ç»“æŸä¹‹å‰çš„æŸ¥è¯¢è¢«å¿½ç•¥
[SQL: 
            SELECT id, user_id, record_date, content, mood_score, reflections
            FROM daily_records
            WHERE user_id = $1
            ORDER BY record_date DESC
            LIMIT 5
        ]
[parameters: (1,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
During task with name 'retrieve' and id '131bc548-4c4f-ed41-5274-aea6c6fa614d'
2025-10-04 20:00:18 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-04 20:00:18 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-04 20:00:18 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-04 20:00:18 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-04 20:00:18 | INFO     | logging:callHandlers:1706 - Finished server process [2450423]
2025-10-04 20:00:23 | INFO     | logging:callHandlers:1706 - Started server process [2451807]
2025-10-04 20:00:23 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-04 20:00:23 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-04 20:00:23 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 20:00:23 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 20:00:23 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 20:00:23 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-04 20:00:54 | INFO     | routes.record:ai_query:171 - å¼€å§‹æŸ¥è¯¢
2025-10-04 20:00:55 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 20:00:56 | INFO     | agents.langgraph.nodes:classify_intent_node:33 - Intent classification result: recent_summary
2025-10-04 20:00:56 | INFO     | agents.langgraph.nodes:prefilter_node:112 - é¢„è¿‡æ»¤è·å–åˆ° 7 æ¡å€™é€‰è®°å½•
2025-10-04 20:00:56 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-04 20:00:56 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-04 20:00:56 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-04 20:00:57 | INFO     | agents.langgraph.nodes:retrieve_node:439 - === å°è¯• 1/3 ===
2025-10-04 20:00:57 | INFO     | agents.langgraph.nodes:retrieve_node:440 - æ—¶é—´èŒƒå›´: None ~ None
2025-10-04 20:00:57 | INFO     | agents.langgraph.nodes:retrieve_node:454 - æ£€ç´¢åˆ° 10 æ¡è®°å½•
2025-10-04 20:00:57 | INFO     | agents.langgraph.nodes:retrieve_node:483 - ç»“æœæ•°è¶³å¤Ÿï¼Œè°ƒç”¨LLMåˆ¤æ–­ç›¸å…³æ€§
2025-10-04 20:00:57 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 20:01:02 | INFO     | agents.langgraph.nodes:retrieve_node:490 - LLMåˆ¤æ–­: can_answer=True, confidence=é«˜, reason=æ£€ç´¢åˆ°çš„è®°å½•åŒ…å«äº†2025-09-16å’Œ2025-09-17ä¸¤å¤©çš„æ—¥è®°å†…å®¹ï¼Œå®Œå…¨ç¬¦åˆç”¨æˆ·è¯¢é—®'æœ€è¿‘ä¸¤å¤©çš„æ—¥è®°'çš„æ—¶é—´èŒƒå›´è¦æ±‚ã€‚è™½ç„¶è®°å½•ä¸­è¿˜åŒ…å«äº†å…¶ä»–æ—¥æœŸçš„æ—¥è®°ï¼Œä½†è¿™ä¸¤å¤©çš„æ—¥è®°å†…å®¹å®Œæ•´ï¼Œèƒ½å¤Ÿå›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚
2025-10-04 20:01:02 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-10-04 20:01:13 | INFO     | routes.record:ai_query:173 - æŸ¥è¯¢æˆåŠŸ
2025-10-04 20:01:13 | INFO     | logging:callHandlers:1706 - 141.11.46.220:0 - "POST /record/ai/1/query HTTP/1.1" 200
2025-10-04 21:22:41 | INFO     | logging:callHandlers:1706 - 195.178.110.157:0 - "GET / HTTP/1.1" 200
2025-10-04 21:43:24 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wp-admin/setup-config.php HTTP/1.1" 404
2025-10-04 21:44:43 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wp-admin/setup-config.php HTTP/1.1" 404
2025-10-04 21:45:02 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wordpress/wp-admin/setup-config.php HTTP/1.1" 404
2025-10-04 21:45:26 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wordpress/wp-admin/setup-config.php HTTP/1.1" 404
2025-10-04 21:58:39 | INFO     | logging:callHandlers:1706 - 46.116.138.10:0 - "GET / HTTP/1.1" 200
2025-10-05 01:20:38 | INFO     | logging:callHandlers:1706 - 195.211.188.185:0 - "GET / HTTP/1.1" 200
2025-10-05 01:29:28 | INFO     | logging:callHandlers:1706 - 124.222.142.44:0 - "GET / HTTP/1.1" 200
2025-10-05 02:08:53 | INFO     | logging:callHandlers:1706 - 43.157.95.239:0 - "GET / HTTP/1.1" 200
2025-10-05 04:44:13 | INFO     | logging:callHandlers:1706 - 17.241.219.240:0 - "GET /robots.txt HTTP/1.1" 404
2025-10-05 08:54:52 | INFO     | logging:callHandlers:1706 - 111.172.249.49:0 - "GET / HTTP/1.1" 200
2025-10-05 09:33:11 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:33:11 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:33:11 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:33:11 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:33:11 | INFO     | logging:callHandlers:1706 - Finished server process [2451807]
2025-10-05 09:33:16 | INFO     | logging:callHandlers:1706 - Started server process [2668040]
2025-10-05 09:33:16 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:33:16 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:33:16 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:33:16 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:33:16 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:33:16 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:34:26 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:34:26 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:34:26 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:34:26 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:34:26 | INFO     | logging:callHandlers:1706 - Finished server process [2668040]
2025-10-05 09:34:31 | INFO     | logging:callHandlers:1706 - Started server process [2668664]
2025-10-05 09:34:31 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:34:31 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:34:31 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:34:31 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:34:31 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:34:31 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:35:15 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:35:15 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:35:15 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:35:15 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:35:15 | INFO     | logging:callHandlers:1706 - Finished server process [2668664]
2025-10-05 09:35:20 | INFO     | logging:callHandlers:1706 - Started server process [2669074]
2025-10-05 09:35:20 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:35:20 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:35:20 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:35:20 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:35:20 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:35:20 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:38:08 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:38:08 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:38:08 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:38:08 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:38:08 | INFO     | logging:callHandlers:1706 - Finished server process [2669074]
2025-10-05 09:38:13 | INFO     | logging:callHandlers:1706 - Started server process [2671385]
2025-10-05 09:38:13 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:38:13 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:38:13 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:38:13 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:38:13 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:38:13 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:41:41 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:41:41 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:41:41 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:41:41 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:41:41 | INFO     | logging:callHandlers:1706 - Finished server process [2671385]
2025-10-05 09:41:46 | INFO     | logging:callHandlers:1706 - Started server process [2673151]
2025-10-05 09:41:46 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:41:46 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:41:46 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:41:46 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:41:46 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:41:47 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:41:54 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:41:54 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:41:54 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:41:54 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:41:54 | INFO     | logging:callHandlers:1706 - Finished server process [2673151]
2025-10-05 09:41:59 | INFO     | logging:callHandlers:1706 - Started server process [2673310]
2025-10-05 09:41:59 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:41:59 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:41:59 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:41:59 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:41:59 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:41:59 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:42:46 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:42:46 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:42:46 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:42:46 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:42:46 | INFO     | logging:callHandlers:1706 - Finished server process [2673310]
2025-10-05 09:42:51 | INFO     | logging:callHandlers:1706 - Started server process [2673826]
2025-10-05 09:42:51 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:42:51 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:42:51 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:42:51 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:42:51 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:42:51 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:46:20 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 09:46:20 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 09:46:20 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 09:46:20 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 09:46:20 | INFO     | logging:callHandlers:1706 - Finished server process [2673826]
2025-10-05 09:46:25 | INFO     | logging:callHandlers:1706 - Started server process [2675628]
2025-10-05 09:46:25 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 09:46:25 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 09:46:25 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 09:46:25 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 09:46:25 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 09:46:25 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 09:58:46 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wordpress/wp-admin/setup-config.php HTTP/1.1" 404
2025-10-05 09:59:11 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wordpress/wp-admin/setup-config.php HTTP/1.1" 404
2025-10-05 09:59:26 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wp-admin/setup-config.php HTTP/1.1" 404
2025-10-05 10:00:20 | INFO     | logging:callHandlers:1706 - 2a06:98c0:3600::103:0 - "GET /wp-admin/setup-config.php HTTP/1.1" 404
2025-10-05 10:01:08 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:01:08 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:01:08 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:01:08 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:01:08 | INFO     | logging:callHandlers:1706 - Finished server process [2675628]
2025-10-05 10:01:13 | INFO     | logging:callHandlers:1706 - Started server process [2682665]
2025-10-05 10:01:13 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:01:13 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:01:13 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:01:13 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:01:13 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:01:13 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:01:19 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:01:19 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:01:19 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:01:19 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:01:19 | INFO     | logging:callHandlers:1706 - Finished server process [2682665]
2025-10-05 10:01:24 | INFO     | logging:callHandlers:1706 - Started server process [2682779]
2025-10-05 10:01:24 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:01:24 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:01:24 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:01:24 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:01:24 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:01:24 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:02:35 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:02:35 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:02:35 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:02:35 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:02:35 | INFO     | logging:callHandlers:1706 - Finished server process [2682779]
2025-10-05 10:02:40 | INFO     | logging:callHandlers:1706 - Started server process [2683423]
2025-10-05 10:02:40 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:02:40 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:02:40 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:02:40 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:02:40 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:02:41 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:05:13 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:05:13 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:05:13 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:05:13 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:05:13 | INFO     | logging:callHandlers:1706 - Finished server process [2683423]
2025-10-05 10:05:18 | INFO     | logging:callHandlers:1706 - Started server process [2684787]
2025-10-05 10:05:18 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:05:18 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:05:18 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:05:18 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:05:18 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:05:19 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:16:45 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:16:45 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:16:45 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:16:45 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:16:45 | INFO     | logging:callHandlers:1706 - Finished server process [2684787]
2025-10-05 10:16:50 | INFO     | logging:callHandlers:1706 - Started server process [2690208]
2025-10-05 10:16:50 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:16:50 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:16:50 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:16:50 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:16:50 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:16:51 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:16:53 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:16:53 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:16:53 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:16:53 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:16:53 | INFO     | logging:callHandlers:1706 - Finished server process [2690208]
2025-10-05 10:16:58 | INFO     | logging:callHandlers:1706 - Started server process [2690330]
2025-10-05 10:16:58 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:16:58 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:16:58 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:16:58 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:16:58 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:16:58 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:19:45 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:19:46 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:19:46 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:19:46 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:19:46 | INFO     | logging:callHandlers:1706 - Finished server process [2690330]
2025-10-05 10:19:51 | INFO     | logging:callHandlers:1706 - Started server process [2691757]
2025-10-05 10:19:51 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:19:51 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:19:51 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:19:51 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:19:51 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:19:51 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:29:15 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:29:15 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:29:15 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:29:15 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:29:15 | INFO     | logging:callHandlers:1706 - Finished server process [2691757]
2025-10-05 10:29:20 | INFO     | logging:callHandlers:1706 - Started server process [2696433]
2025-10-05 10:29:20 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:29:20 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:29:20 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:29:20 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:29:20 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:29:20 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:30:06 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:30:06 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:30:06 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:30:06 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:30:06 | INFO     | logging:callHandlers:1706 - Finished server process [2696433]
2025-10-05 10:30:11 | INFO     | logging:callHandlers:1706 - Started server process [2697010]
2025-10-05 10:30:11 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:30:11 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:30:11 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:30:11 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:30:11 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:30:11 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:30:15 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:30:15 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:30:15 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:30:15 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:30:15 | INFO     | logging:callHandlers:1706 - Finished server process [2697010]
2025-10-05 10:30:20 | INFO     | logging:callHandlers:1706 - Started server process [2697141]
2025-10-05 10:30:20 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:30:20 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:30:20 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:30:20 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:30:20 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:30:20 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:36:53 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:36:53 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:36:53 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:36:53 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:36:53 | INFO     | logging:callHandlers:1706 - Finished server process [2697141]
2025-10-05 10:36:58 | INFO     | logging:callHandlers:1706 - Started server process [2700369]
2025-10-05 10:36:58 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:36:58 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:36:58 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:36:58 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:36:58 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:36:58 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:44:07 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:44:07 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:44:07 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:44:07 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:44:07 | INFO     | logging:callHandlers:1706 - Finished server process [2700369]
2025-10-05 10:44:13 | INFO     | logging:callHandlers:1706 - Started server process [2703825]
2025-10-05 10:44:13 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:44:13 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:44:13 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:44:13 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:44:13 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:44:13 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:47:39 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:47:39 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:47:39 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:47:39 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:47:39 | INFO     | logging:callHandlers:1706 - Finished server process [2703825]
2025-10-05 10:47:44 | INFO     | logging:callHandlers:1706 - Started server process [2705570]
2025-10-05 10:47:44 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:47:44 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:47:44 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:47:44 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:47:44 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:47:45 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:48:44 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:48:44 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:48:44 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:48:44 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:48:44 | INFO     | logging:callHandlers:1706 - Finished server process [2705570]
2025-10-05 10:48:49 | INFO     | logging:callHandlers:1706 - Started server process [2706247]
2025-10-05 10:48:49 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:48:49 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:48:49 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:48:49 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:48:49 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:48:49 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:53:41 | INFO     | logging:callHandlers:1706 - 43.166.253.94:0 - "GET / HTTP/1.1" 200
2025-10-05 10:54:19 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:54:19 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:54:19 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:54:19 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:54:19 | INFO     | logging:callHandlers:1706 - Finished server process [2706247]
2025-10-05 10:54:24 | INFO     | logging:callHandlers:1706 - Started server process [2709290]
2025-10-05 10:54:24 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:54:24 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:54:24 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:54:24 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:54:24 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:54:25 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:54:32 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:54:32 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:54:32 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:54:32 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:54:32 | INFO     | logging:callHandlers:1706 - Finished server process [2709290]
2025-10-05 10:54:37 | INFO     | logging:callHandlers:1706 - Started server process [2709440]
2025-10-05 10:54:37 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:54:37 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:54:37 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:54:37 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:54:37 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:54:37 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 10:58:16 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 10:58:16 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 10:58:16 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 10:58:16 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 10:58:16 | INFO     | logging:callHandlers:1706 - Finished server process [2709440]
2025-10-05 10:58:21 | INFO     | logging:callHandlers:1706 - Started server process [2711697]
2025-10-05 10:58:21 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 10:58:21 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 10:58:21 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 10:58:21 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 10:58:21 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 10:58:21 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:04:14 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:04:14 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:04:14 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:04:14 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:04:14 | INFO     | logging:callHandlers:1706 - Finished server process [2711697]
2025-10-05 11:04:19 | INFO     | logging:callHandlers:1706 - Started server process [2718321]
2025-10-05 11:04:19 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:04:19 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:04:19 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:04:19 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:04:19 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:04:20 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:04:40 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:04:40 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:04:40 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:04:40 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:04:40 | INFO     | logging:callHandlers:1706 - Finished server process [2718321]
2025-10-05 11:04:45 | INFO     | logging:callHandlers:1706 - Started server process [2719283]
2025-10-05 11:04:45 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:04:45 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:04:45 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:04:45 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:04:45 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:04:45 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:04:48 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:04:48 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:04:48 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:04:48 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:04:48 | INFO     | logging:callHandlers:1706 - Finished server process [2719283]
2025-10-05 11:04:53 | INFO     | logging:callHandlers:1706 - Started server process [2719436]
2025-10-05 11:04:53 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:04:53 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:04:53 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:04:54 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:04:54 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:04:54 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:18:45 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:18:45 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:18:45 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:18:45 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:18:45 | INFO     | logging:callHandlers:1706 - Finished server process [2719436]
2025-10-05 11:18:50 | INFO     | logging:callHandlers:1706 - Started server process [2727356]
2025-10-05 11:18:50 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:18:50 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:18:50 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:18:50 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:18:50 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:18:50 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:21:00 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:21:00 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:21:00 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:21:00 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:21:00 | INFO     | logging:callHandlers:1706 - Finished server process [2727356]
2025-10-05 11:21:05 | INFO     | logging:callHandlers:1706 - Started server process [2728734]
2025-10-05 11:21:05 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:21:05 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:21:05 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:21:05 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:21:05 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:21:05 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:48:34 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:48:34 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:48:34 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:48:34 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:48:34 | INFO     | logging:callHandlers:1706 - Finished server process [2728734]
2025-10-05 11:48:39 | INFO     | logging:callHandlers:1706 - Started server process [2743019]
2025-10-05 11:48:39 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:48:39 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:48:39 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:48:39 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:48:39 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:48:39 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:48:43 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:48:43 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:48:43 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:48:43 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:48:43 | INFO     | logging:callHandlers:1706 - Finished server process [2743019]
2025-10-05 11:48:48 | INFO     | logging:callHandlers:1706 - Started server process [2743121]
2025-10-05 11:48:48 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:48:48 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:48:48 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:48:48 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:48:48 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:48:48 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:51:14 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:51:14 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:51:14 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:51:14 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:51:14 | INFO     | logging:callHandlers:1706 - Finished server process [2743121]
2025-10-05 11:51:21 | INFO     | logging:callHandlers:1706 - Started server process [2744974]
2025-10-05 11:51:21 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:51:21 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:51:21 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:51:21 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:51:21 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:51:22 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:51:27 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:51:27 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:51:27 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:51:27 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:51:27 | INFO     | logging:callHandlers:1706 - Finished server process [2744974]
2025-10-05 11:51:32 | INFO     | logging:callHandlers:1706 - Started server process [2745085]
2025-10-05 11:51:32 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:51:32 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:51:32 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:51:32 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:51:32 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:51:32 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:51:33 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:51:33 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:51:33 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:51:33 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:51:33 | INFO     | logging:callHandlers:1706 - Finished server process [2745085]
2025-10-05 11:51:38 | INFO     | logging:callHandlers:1706 - Started server process [2745157]
2025-10-05 11:51:38 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:51:38 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:51:38 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:51:38 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:51:38 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:51:38 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:52:42 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:52:42 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:52:42 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:52:42 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:52:42 | INFO     | logging:callHandlers:1706 - Finished server process [2745157]
2025-10-05 11:52:47 | INFO     | logging:callHandlers:1706 - Started server process [2745857]
2025-10-05 11:52:47 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:52:47 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:52:47 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:52:47 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:52:47 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:52:47 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:52:53 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:52:53 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:52:53 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:52:53 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:52:53 | INFO     | logging:callHandlers:1706 - Finished server process [2745857]
2025-10-05 11:52:59 | INFO     | logging:callHandlers:1706 - Started server process [2746042]
2025-10-05 11:52:59 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:52:59 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:52:59 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:52:59 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:52:59 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:52:59 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:54:26 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:54:26 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:54:26 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:54:26 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:54:26 | INFO     | logging:callHandlers:1706 - Finished server process [2746042]
2025-10-05 11:54:31 | INFO     | logging:callHandlers:1706 - Started server process [2746977]
2025-10-05 11:54:31 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:54:31 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:54:31 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:54:31 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:54:31 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:54:32 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 11:54:36 | INFO     | logging:callHandlers:1706 - Shutting down
2025-10-05 11:54:36 | INFO     | logging:callHandlers:1706 - Waiting for application shutdown.
2025-10-05 11:54:36 | INFO     | main:lifespan:22 - ğŸ›‘ Shutting down FastAPI application...
2025-10-05 11:54:36 | INFO     | logging:callHandlers:1706 - Application shutdown complete.
2025-10-05 11:54:36 | INFO     | logging:callHandlers:1706 - Finished server process [2746977]
2025-10-05 11:54:41 | INFO     | logging:callHandlers:1706 - Started server process [2747086]
2025-10-05 11:54:41 | INFO     | logging:callHandlers:1706 - Waiting for application startup.
2025-10-05 11:54:41 | INFO     | main:lifespan:18 - ğŸš€ Starting FastAPI application...
2025-10-05 11:54:41 | INFO     | service.embedding:load_model_sentence_transformers:6 - ä½¿ç”¨ sentence-transformers åŠ è½½æ¨¡å‹...
2025-10-05 11:54:41 | INFO     | logging:callHandlers:1706 - Use pytorch device_name: cuda:0
2025-10-05 11:54:41 | INFO     | logging:callHandlers:1706 - Load pretrained SentenceTransformer: BAAI/bge-small-zh-v1.5
2025-10-05 11:54:41 | INFO     | logging:callHandlers:1706 - Application startup complete.
2025-10-05 12:22:41 | INFO     | logging:callHandlers:1706 - 2001:4ca0:108:42::24:0 - "GET /robots.txt HTTP/1.1" 404
2025-10-05 12:28:12 | INFO     | logging:callHandlers:1706 - 198.235.24.53:0 - "GET /.well-known/security.txt HTTP/1.1" 404
2025-10-05 12:47:44 | INFO     | logging:callHandlers:1706 - 2409:8a63:315:f3a2:25ec:4260:f3e9:d20a:0 - "GET /summary/users/1/today HTTP/1.1" 200
2025-10-05 12:47:44 | INFO     | logging:callHandlers:1706 - 2409:8a63:315:f3a2:25ec:4260:f3e9:d20a:0 - "GET /news/bilibili?limit=3 HTTP/1.1" 200
2025-10-05 12:47:45 | INFO     | logging:callHandlers:1706 - 2409:8a63:315:f3a2:25ec:4260:f3e9:d20a:0 - "GET /weather/104.04304928584422/30.548247026479537 HTTP/1.1" 200
2025-10-05 15:06:58 | INFO     | logging:callHandlers:1706 - 2001:4ca0:108:42::24:0 - "GET /robots.txt HTTP/1.1" 404
